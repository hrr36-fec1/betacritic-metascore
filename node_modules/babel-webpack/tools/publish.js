const task = require('./task');
const s3 = require('s3');

module.exports = task('publish', () => new Promise((resolve, reject) => {
  const client = s3.createClient({
    s3Options: {
      region: 'us-east-1',
      sslEnabled: true,
    },
  });
  const uploader = client.uploadDir({
    localDir: './build',
    deleteRemoved: true,
    s3Params: { Bucket: 'sisolider.com.br' },
  });
  uploader.on('error', reject);
  uploader.on('end', resolve);
}));
